import aggregation_PBC

# THE INPUT FOR THIS PROGRAM SHOULD BE A WRAPPED TRAJECTORY WITH NO WATER IN PDB FORMAT GENERATED BY CPPTRAJ.

# Specify box length. You can determine the box length by using cpptraj. 
box_length = 80

# Read in trajectory
with open("B-D-Glc_OPC_wrapped.pdb") as f:
    traj = f.read().splitlines()

# Make a list of all frames, where each element is one frame in pdb format (also a list).
frames = []
current_frame = []

# This will separate each frame using ENDMDL as a delimiter.
for line in traj:
    if "ENDMDL" in line:
        frames.append(current_frame)
        current_frame=[]
    else:
        current_frame.append(line)


output_file = open("agg_data_B-D-Glc_OPC.txt","w")

for frame in frames:
    num_agg, avg_agg_size = aggregation_PBC.calculate_aggregates(frame, box_length)
    print("Number of aggregates and avg aggregate size:", num_agg, avg_agg_size)
    output_file.write(f"{num_agg} {avg_agg_size}\n")

output_file.close()

